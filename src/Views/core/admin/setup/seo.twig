{% extends 'layouts/dashboard.twig' %}

{% block title %}SEO Setup{% endblock %}
{% block page_title %}SEO Setup{% endblock %}

{% block content %}
<div class="w-full">
    <div class="card bg-base-100 border border-base-300">
        <div class="admin-card-body">
            <h2 class="card-title mb-4">SEO Setup</h2>
            <form method="POST" action="/admin/setup/seo" enctype="multipart/form-data" novalidate>
                <input type="hidden" name="_token" value="{{ csrf_token }}">

                <div class="card bg-base-200/40 border border-base-300 mb-6">
                    <div class="admin-card-body">
                        <h3 class="admin-section-title mb-2">Shop SEO Metadata</h3>
                        <div class="admin-form-control">
                            <label class="label" for="seo_title">
                                <span class="label-text font-semibold">SEO Title</span>
                            </label>
                            <input
                                type="text"
                                name="seo[seo_title]"
                                id="seo_title"
                                value="{{ data.seo.seo_title ?? seo_metadata.seo_title ?? '' }}"
                                class="admin-input {% if errors['seo.seo_title'] %}input-error{% endif %}"
                            />
                            {% if errors['seo.seo_title'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['seo.seo_title'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="seo_description">
                                <span class="label-text font-semibold">SEO Description</span>
                            </label>
                            <textarea
                                name="seo[seo_description]"
                                id="seo_description"
                                class="admin-textarea {% if errors['seo.seo_description'] %}textarea-error{% endif %}"
                                rows="3"
                            >{{ data.seo.seo_description ?? seo_metadata.seo_description ?? '' }}</textarea>
                            {% if errors['seo.seo_description'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['seo.seo_description'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="seo_keywords">
                                <span class="label-text font-semibold">SEO Keywords</span>
                            </label>
                            <input
                                type="text"
                                name="seo[seo_keywords]"
                                id="seo_keywords"
                                value="{{ data.seo.seo_keywords ?? seo_metadata.seo_keywords ?? '' }}"
                                class="admin-input {% if errors['seo.seo_keywords'] %}input-error{% endif %}"
                            />
                            {% if errors['seo.seo_keywords'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['seo.seo_keywords'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                    </div>
                </div>

                <div class="card bg-base-200/40 border border-base-300 mb-6">
                    <div class="admin-card-body">
                        <h3 class="admin-section-title mb-2">Social Media Links</h3>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                            <div class="admin-form-control">
                                <label class="label" for="seo_facebook">
                                    <span class="label-text font-semibold">Facebook</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[facebook]"
                                    id="seo_facebook"
                                    value="{{ data.seo.facebook ?? shop_metadata.social_media_links.facebook ?? '' }}"
                                    placeholder="https://facebook.com/YourPageName"
                                    class="admin-input {% if errors['seo.facebook'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.facebook'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.facebook'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_instagram">
                                    <span class="label-text font-semibold">Instagram</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[instagram]"
                                    id="seo_instagram"
                                    value="{{ data.seo.instagram ?? shop_metadata.social_media_links.instagram ?? '' }}"
                                    placeholder="https://instagram.com/YourUsername"
                                    class="admin-input {% if errors['seo.instagram'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.instagram'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.instagram'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_x">
                                    <span class="label-text font-semibold">X (formerly Twitter)</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[x]"
                                    id="seo_x"
                                    value="{{ data.seo.x ?? shop_metadata.social_media_links.x ?? '' }}"
                                    placeholder="https://x.com/YourHandle"
                                    class="admin-input {% if errors['seo.x'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.x'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.x'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_linkedin">
                                    <span class="label-text font-semibold">LinkedIn</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[linkedin]"
                                    id="seo_linkedin"
                                    value="{{ data.seo.linkedin ?? shop_metadata.social_media_links.linkedin ?? '' }}"
                                    placeholder="https://linkedin.com/company/YourCompany"
                                    class="admin-input {% if errors['seo.linkedin'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.linkedin'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.linkedin'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_youtube">
                                    <span class="label-text font-semibold">YouTube</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[youtube]"
                                    id="seo_youtube"
                                    value="{{ data.seo.youtube ?? shop_metadata.social_media_links.youtube ?? '' }}"
                                    placeholder="https://youtube.com/YourChannel"
                                    class="admin-input {% if errors['seo.youtube'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.youtube'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.youtube'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_pinterest">
                                    <span class="label-text font-semibold">Pinterest</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[pinterest]"
                                    id="seo_pinterest"
                                    value="{{ data.seo.pinterest ?? shop_metadata.social_media_links.pinterest ?? '' }}"
                                    placeholder="https://pinterest.com/YourBoard"
                                    class="admin-input {% if errors['seo.pinterest'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.pinterest'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.pinterest'] }}</span>
                                    </label>
                                {% endif %}
                            </div>

                            <div class="admin-form-control">
                                <label class="label" for="seo_whatsapp">
                                    <span class="label-text font-semibold">WhatsApp</span>
                                </label>
                                <input
                                    type="text"
                                    name="seo[whatsapp]"
                                    id="seo_whatsapp"
                                    value="{{ data.seo.whatsapp ?? shop_metadata.social_media_links.whatsapp ?? '' }}"
                                    placeholder="https://wa.me/15551234567"
                                    class="admin-input {% if errors['seo.whatsapp'] %}input-error{% endif %}"
                                />
                                {% if errors['seo.whatsapp'] %}
                                    <label class="label">
                                        <span class="label-text-alt text-error">{{ errors['seo.whatsapp'] }}</span>
                                    </label>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card bg-base-200/40 border border-base-300 mb-6">
                    <div class="admin-card-body">
                        <h3 class="admin-section-title mb-2">Open Graph</h3>
                        <div class="admin-form-control">
                            <label class="label" for="og_title">
                                <span class="label-text font-semibold">OG Title</span>
                            </label>
                            <input
                                type="text"
                                name="seo[og_title]"
                                id="og_title"
                                value="{{ data.seo.og_title ?? seo_metadata.og_title ?? '' }}"
                                class="admin-input {% if errors['seo.og_title'] %}input-error{% endif %}"
                            />
                            {% if errors['seo.og_title'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['seo.og_title'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="og_description">
                                <span class="label-text font-semibold">OG Description</span>
                            </label>
                            <textarea
                                name="seo[og_description]"
                                id="og_description"
                                class="admin-textarea {% if errors['seo.og_description'] %}textarea-error{% endif %}"
                                rows="3"
                            >{{ data.seo.og_description ?? seo_metadata.og_description ?? '' }}</textarea>
                            {% if errors['seo.og_description'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['seo.og_description'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="og_image">
                                <span class="label-text font-semibold">OG Image (1200x630)</span>
                            </label>
                            <input
                                type="file"
                                name="og_image"
                                id="og_image"
                                accept="image/png,image/jpeg,image/webp"
                                class="file-input file-input-bordered w-full"
                            />
                            <p class="text-xs text-base-content/60 mt-1">We resize to fit within 1200x630 and convert to WebP.</p>
                            {% if seo_metadata and seo_metadata.og_image %}
                                <img
                                    src="/media/{{ seo_metadata.og_image }}"
                                    alt="OG image preview"
                                    class="mt-2 max-w-xs rounded bg-base-200 object-cover"
                                />
                            {% endif %}
                            {% if errors.og_image %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors.og_image }}</span>
                                </label>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="card bg-base-200/40 border border-base-300 mb-6">
                    <div class="admin-card-body">
                        <h3 class="admin-section-title mb-2">Third-Party Scripts</h3>
                        <p class="text-sm text-base-content/70 mb-4">Add trusted scripts for analytics, chat, or widgets. These render only on the storefront.</p>
                        <div class="admin-form-control">
                            <label class="label" for="third_party_head_html">
                                <span class="label-text font-semibold">Head HTML</span>
                            </label>
                            <textarea
                                name="third_party[head_html]"
                                id="third_party_head_html"
                                class="admin-textarea {% if errors['third_party.head_html'] %}textarea-error{% endif %}"
                                rows="4"
                            >{{ data.third_party.head_html ?? shop_metadata.third_party.head_html ?? '' }}</textarea>
                            <p class="text-xs text-base-content/60 mt-1">For analytics scripts that must load inside &lt;head&gt;.</p>
                            {% if errors['third_party.head_html'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['third_party.head_html'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="third_party_body_start_html">
                                <span class="label-text font-semibold">Body Start HTML</span>
                            </label>
                            <textarea
                                name="third_party[body_start_html]"
                                id="third_party_body_start_html"
                                class="admin-textarea {% if errors['third_party.body_start_html'] %}textarea-error{% endif %}"
                                rows="4"
                            >{{ data.third_party.body_start_html ?? shop_metadata.third_party.body_start_html ?? '' }}</textarea>
                            <p class="text-xs text-base-content/60 mt-1">For noscript or tag manager body snippets.</p>
                            {% if errors['third_party.body_start_html'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['third_party.body_start_html'] }}</span>
                                </label>
                            {% endif %}
                        </div>

                        <div class="admin-form-control">
                            <label class="label" for="third_party_body_end_html">
                                <span class="label-text font-semibold">Body End HTML</span>
                            </label>
                            <textarea
                                name="third_party[body_end_html]"
                                id="third_party_body_end_html"
                                class="admin-textarea {% if errors['third_party.body_end_html'] %}textarea-error{% endif %}"
                                rows="4"
                            >{{ data.third_party.body_end_html ?? shop_metadata.third_party.body_end_html ?? '' }}</textarea>
                            <p class="text-xs text-base-content/60 mt-1">For chat widgets or scripts that should load late.</p>
                            {% if errors['third_party.body_end_html'] %}
                                <label class="label">
                                    <span class="label-text-alt text-error">{{ errors['third_party.body_end_html'] }}</span>
                                </label>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="admin-form-actions">
                    <button type="submit" class="btn btn-primary btn-sm">Save SEO Settings</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
